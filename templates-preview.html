<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Шаблоны игр - Artel Billiards</title>
    
    <style>
        /* Design Tokens */
        :root {
            /* Colors */
            --color-primary: #41B3A3;
            --color-mint: #85DCCB;
            --color-coral: #E27D60;
            --color-peach: #E8A87C;
            --color-rose-purple: #C38D9E;
            
            --color-black: #0a0a0a;
            --color-gray-900: #121212;
            --color-gray-800: #1a1a1a;
            --color-gray-700: #2a2a2a;
            --color-gray-600: #333333;
            --color-gray-500: #4a4a4a;
            --color-gray-300: #b0b0b0;
            --color-white: #ffffff;
            
            --color-success: #22c55e;
            --color-warning: #f59e0b;
            --color-error: #ef4444;
            
            /* Typography */
            --font-family: 'Inter', system-ui, -apple-system, sans-serif;
            
            /* Spacing */
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 12px;
            --spacing-lg: 16px;
            --spacing-xl: 24px;
            --spacing-2xl: 32px;
            --spacing-3xl: 48px;
            
            /* Radii */
            --radius-sm: 10px;
            --radius-md: 14px;
            --radius-lg: 18px;
            --radius-xl: 24px;
            --radius-pill: 999px;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.08);
            --shadow-md: 0 6px 16px rgba(0,0,0,0.16);
            --shadow-lg: 0 12px 28px rgba(0,0,0,0.22);
            --shadow-glow-mint: 0 10px 20px rgba(133, 220, 203, 0.25);
            --shadow-glow-coral: 0 10px 20px rgba(226, 125, 96, 0.25);
            
            /* Transitions */
            --transition-fast: 150ms ease-in-out;
            --transition-normal: 250ms ease-in-out;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--color-gray-700);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-gray-500);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-gray-600);
        }

        * {
            scrollbar-width: thin;
            scrollbar-color: var(--color-gray-500) var(--color-gray-700);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font-family);
            background: var(--color-black);
            color: var(--color-white);
            line-height: 1.5;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--spacing-lg);
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: var(--spacing-3xl);
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-mint), var(--color-coral));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .page-subtitle {
            font-size: 1.125rem;
            color: var(--color-gray-300);
            margin-bottom: var(--spacing-lg);
        }
        
        /* Templates Grid */
        .templates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-3xl);
        }
        
        .template-card {
            background: var(--color-gray-800);
            border: 1px solid var(--color-gray-600);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
            transition: all var(--transition-normal);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .template-card:hover {
            border-color: var(--color-mint);
            box-shadow: var(--shadow-glow-mint);
            transform: translateY(-4px);
        }
        
        .template-card.create-custom {
            border: 2px dashed var(--color-gray-600);
            background: var(--color-gray-900);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 320px;
        }
        
        .template-card.create-custom:hover {
            border-color: var(--color-coral);
            background: var(--color-gray-800);
            box-shadow: var(--shadow-glow-coral);
        }
        
        .template-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--color-mint), var(--color-primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: var(--spacing-lg);
        }
        
        .template-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-md);
            color: var(--color-white);
        }
        
        .template-description {
            color: var(--color-gray-300);
            margin-bottom: var(--spacing-xl);
            line-height: 1.6;
        }
        
        .template-settings {
            margin-bottom: var(--spacing-xl);
        }
        
        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--color-gray-700);
        }
        
        .setting-row:last-child {
            border-bottom: none;
        }
        
        .setting-label {
            font-size: 0.875rem;
            color: var(--color-gray-300);
        }
        
        .setting-value {
            font-weight: 600;
            color: var(--color-mint);
            font-size: 0.875rem;
        }
        
        .template-button {
            background: linear-gradient(135deg, var(--color-mint), var(--color-primary));
            color: var(--color-black);
            border: none;
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .template-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        .template-button:active {
            transform: translateY(0);
        }
        
        /* Create Custom Template */
        .create-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--color-coral), var(--color-peach));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            margin-bottom: var(--spacing-xl);
            transition: all var(--transition-normal);
        }
        
        .template-card.create-custom:hover .create-icon {
            transform: scale(1.1) rotate(90deg);
        }
        
        .create-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: var(--spacing-md);
            color: var(--color-white);
        }
        
        .create-description {
            color: var(--color-gray-300);
            margin-bottom: var(--spacing-xl);
        }
        
        .create-button {
            background: linear-gradient(135deg, var(--color-coral), var(--color-peach));
            color: var(--color-white);
            border: none;
            padding: var(--spacing-md) var(--spacing-2xl);
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .create-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        /* Badge */
        .template-badge {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            background: var(--color-success);
            color: var(--color-white);
            padding: var(--spacing-xs) var(--spacing-md);
            border-radius: var(--radius-pill);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: var(--spacing-lg);
        }
        
        .modal-overlay.show {
            display: flex;
        }
        
        .modal-content {
            background: var(--color-gray-800);
            border-radius: var(--radius-lg);
            padding: var(--spacing-2xl);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--color-gray-600);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid var(--color-gray-700);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-white);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }
        
        .modal-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--color-mint), var(--color-primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .close-button {
            background: none;
            border: none;
            color: var(--color-gray-300);
            font-size: 1.5rem;
            cursor: pointer;
            padding: var(--spacing-sm);
            border-radius: var(--radius-sm);
            transition: all var(--transition-fast);
        }
        
        .close-button:hover {
            background: var(--color-gray-700);
            color: var(--color-white);
        }
        
        /* Settings Grid в модале */
        .modal-settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .modal-setting-item {
            background: var(--color-gray-700);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
        }
        
        .modal-setting-title {
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--color-white);
            font-size: 0.875rem;
        }
        
        .modal-setting-value {
            color: var(--color-mint);
            font-weight: 600;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--color-gray-600);
            border-radius: var(--radius-pill);
            display: inline-block;
            font-size: 0.875rem;
        }
        
        /* Balls Section в модале */
        .modal-balls-section {
            margin-bottom: var(--spacing-xl);
        }
        
        .modal-section-title {
            color: var(--color-mint);
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            font-size: 1.125rem;
        }
        
        .modal-balls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }
        
        .modal-ball-item {
            background: var(--color-gray-700);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            text-align: center;
            transition: all var(--transition-fast);
        }
        
        .modal-ball-item:hover {
            background: var(--color-gray-600);
            transform: translateY(-2px);
        }
        
        .modal-ball {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin: 0 auto var(--spacing-sm);
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.3), inset 2px 2px 6px rgba(255,255,255,0.1);
            position: relative;
        }
        
        .modal-ball::after {
            content: '';
            position: absolute;
            top: 6px;
            left: 10px;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), transparent 60%);
            border-radius: 50%;
        }
        
        .modal-ball.white { background: #ffffff; border: 1px solid var(--color-gray-600); }
        .modal-ball.yellow { background: #ffeb3b; }
        .modal-ball.green { background: #4caf50; }
        .modal-ball.brown { background: #8d6e63; }
        .modal-ball.blue { background: #2196f3; }
        .modal-ball.pink { background: #e91e63; }
        .modal-ball.black { background: #212121; }
        .modal-ball.red { background: #f44336; }
        
        .modal-ball-name {
            font-weight: 600;
            color: var(--color-white);
            margin-bottom: var(--spacing-xs);
            font-size: 0.75rem;
        }
        
        .modal-ball-points {
            font-size: 0.7rem;
            color: var(--color-gray-300);
        }
        
        /* Scoring Section в модале */
        .modal-scoring-section {
            margin-bottom: var(--spacing-xl);
        }
        
        .modal-scoring-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .modal-scoring-item {
            background: var(--color-gray-700);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
        }
        
        .modal-scoring-label {
            font-size: 0.875rem;
            color: var(--color-gray-300);
            margin-bottom: var(--spacing-sm);
        }
        
        .modal-scoring-value {
            color: var(--color-mint);
            font-weight: 600;
            font-size: 1.125rem;
        }
        
        .modal-action-buttons {
            display: flex;
            gap: var(--spacing-md);
            justify-content: flex-end;
        }
        
        .modal-button {
            padding: var(--spacing-md) var(--spacing-xl);
            border-radius: var(--radius-md);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: none;
        }
        
        .modal-button.secondary {
            background: var(--color-gray-600);
            color: var(--color-white);
        }
        
        .modal-button.secondary:hover {
            background: var(--color-gray-500);
        }
        
        .modal-button.primary {
            background: linear-gradient(135deg, var(--color-mint), var(--color-primary));
            color: var(--color-black);
        }
        
        .modal-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        /* Create Template Form */
        .create-form-section {
            margin-bottom: var(--spacing-xl);
        }
        
        .form-section-title {
            color: var(--color-mint);
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            font-size: 1.125rem;
        }
        
        .form-group {
            margin-bottom: var(--spacing-lg);
        }
        
        .form-label {
            display: block;
            font-size: 0.875rem;
            color: var(--color-gray-300);
            margin-bottom: var(--spacing-sm);
            font-weight: 600;
        }
        
        .form-input {
            width: 100%;
            background: var(--color-gray-700);
            border: 1px solid var(--color-gray-600);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            color: var(--color-white);
            font-family: var(--font-family);
            font-size: 0.875rem;
            transition: all var(--transition-fast);
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--color-mint);
            box-shadow: 0 0 0 2px rgba(133, 220, 203, 0.2);
        }
        
        .form-input::placeholder {
            color: var(--color-gray-300);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .form-options {
            display: flex;
            gap: var(--spacing-sm);
            flex-wrap: wrap;
        }
        
        .form-option {
            background: var(--color-gray-600);
            border: 1px solid var(--color-gray-500);
            border-radius: var(--radius-pill);
            padding: var(--spacing-sm) var(--spacing-lg);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.875rem;
            color: var(--color-white);
        }
        
        .form-option:hover {
            border-color: var(--color-mint);
        }
        
        .form-option.selected {
            background: var(--color-mint);
            color: var(--color-black);
            border-color: var(--color-mint);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-lg);
        }
        
        .form-grid-item {
            background: var(--color-gray-700);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
        }
        
        .form-grid-title {
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--color-white);
            font-size: 0.875rem;
        }
        
        .price-input-group {
            display: flex;
            gap: var(--spacing-sm);
            align-items: center;
            flex-wrap: wrap;
        }
        
        .price-option {
            background: var(--color-gray-600);
            border: 1px solid var(--color-gray-500);
            border-radius: var(--radius-pill);
            padding: var(--spacing-sm) var(--spacing-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-size: 0.875rem;
            color: var(--color-white);
            min-width: 50px;
            text-align: center;
        }
        
        .price-option:hover {
            border-color: var(--color-mint);
        }
        
        .price-option.selected {
            background: var(--color-mint);
            color: var(--color-black);
            border-color: var(--color-mint);
        }
        
        .price-input {
            background: var(--color-gray-600);
            border: 1px solid var(--color-gray-500);
            border-radius: var(--radius-pill);
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--color-white);
            font-family: var(--font-family);
            width: 80px;
            text-align: center;
            font-size: 0.875rem;
        }
        
        .price-input:focus {
            outline: none;
            border-color: var(--color-mint);
        }
        
        .balls-config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: var(--spacing-md);
        }
        
        .ball-config-item {
            background: var(--color-gray-600);
            border-radius: var(--radius-md);
            padding: var(--spacing-md);
            text-align: center;
            transition: all var(--transition-fast);
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .ball-config-item:hover {
            background: var(--color-gray-500);
            transform: translateY(-2px);
        }
        
        .ball-config-item.selected {
            border-color: var(--color-mint);
            background: var(--color-gray-500);
        }
        
        .config-ball {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            margin: 0 auto var(--spacing-sm);
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.3), inset 2px 2px 6px rgba(255,255,255,0.1);
            position: relative;
        }
        
        .config-ball::after {
            content: '';
            position: absolute;
            top: 6px;
            left: 10px;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), transparent 60%);
            border-radius: 50%;
        }
        
        .config-ball.white { background: #ffffff; border: 1px solid var(--color-gray-600); }
        .config-ball.yellow { background: #ffeb3b; }
        .config-ball.green { background: #4caf50; }
        .config-ball.brown { background: #8d6e63; }
        .config-ball.blue { background: #2196f3; }
        .config-ball.pink { background: #e91e63; }
        .config-ball.black { background: #212121; }
        .config-ball.red { background: #f44336; }
        
        .config-ball-name {
            font-weight: 600;
            color: var(--color-white);
            margin-bottom: var(--spacing-xs);
            font-size: 0.75rem;
        }
        
        .config-ball-input {
            background: var(--color-gray-700);
            border: 1px solid var(--color-gray-600);
            border-radius: var(--radius-sm);
            padding: var(--spacing-xs) var(--spacing-sm);
            color: var(--color-white);
            font-size: 0.7rem;
            width: 100%;
            text-align: center;
        }
        
        .config-ball-input:focus {
            outline: none;
            border-color: var(--color-mint);
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: var(--spacing-md);
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .templates-grid {
                grid-template-columns: 1fr;
                gap: var(--spacing-lg);
            }
            
            .template-card {
                padding: var(--spacing-lg);
            }
            
            .template-card.create-custom {
                min-height: 280px;
            }
            
            .modal-content {
                margin: var(--spacing-md);
                padding: var(--spacing-lg);
                max-height: 85vh;
            }
            
            .modal-settings-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-balls-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            }
            
            .modal-scoring-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <main class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="page-title">Шаблоны игр</h1>
            <p class="page-subtitle">Выбери готовый шаблон или создай свои правила</p>
        </div>

        <!-- Templates Grid -->
        <div class="templates-grid">
            <!-- Template 1: Колхоз -->
            <div class="template-card" onclick="viewTemplate('kolkhoz')">
                <div class="template-badge">Популярный</div>
                <div class="template-icon">🎱</div>
                <h3 class="template-title">Колхоз</h3>
                <p class="template-description">
                    Классическая русская игра. Простые правила, подходит для начинающих и дружеских партий.
                </p>
                
                <div class="template-settings">
                    <div class="setting-row">
                        <span class="setting-label">Количество шаров:</span>
                        <span class="setting-value">15 шаров</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Условие победы:</span>
                        <span class="setting-value">До последнего</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Стоимость очка:</span>
                        <span class="setting-value">10₽</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Штраф за фол:</span>
                        <span class="setting-value">50₽</span>
                    </div>
                </div>
                
                <button class="template-button" onclick="event.stopPropagation(); viewTemplate('kolkhoz')">Посмотреть шаблон</button>
            </div>

            <!-- Template 2: Американка -->
            <div class="template-card" onclick="viewTemplate('americana')">
                <div class="template-icon">🔴</div>
                <h3 class="template-title">Американка</h3>
                <p class="template-description">
                    Популярная игра в пул. Играйте сплошными или полосатыми шарами, забейте восьмерку для победы.
                </p>
                
                <div class="template-settings">
                    <div class="setting-row">
                        <span class="setting-label">Количество шаров:</span>
                        <span class="setting-value">15 шаров</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Условие победы:</span>
                        <span class="setting-value">Забить 8-ку</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Стоимость очка:</span>
                        <span class="setting-value">25₽</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Штраф за фол:</span>
                        <span class="setting-value">100₽</span>
                    </div>
                </div>
                
                <button class="template-button" onclick="event.stopPropagation(); viewTemplate('americana')">Посмотреть шаблон</button>
            </div>

            <!-- Template 3: Пирамида -->
            <div class="template-card" onclick="viewTemplate('pyramid')">
                <div class="template-icon">🔺</div>
                <h3 class="template-title">Пирамида</h3>
                <p class="template-description">
                    Классическая русская пирамида. Требует точности и стратегического мышления.
                </p>
                
                <div class="template-settings">
                    <div class="setting-row">
                        <span class="setting-label">Количество шаров:</span>
                        <span class="setting-value">15 шаров</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Условие победы:</span>
                        <span class="setting-value">До 71 очка</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Стоимость очка:</span>
                        <span class="setting-value">50₽</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Штраф за фол:</span>
                        <span class="setting-value">200₽</span>
                    </div>
                </div>
                
                <button class="template-button" onclick="event.stopPropagation(); viewTemplate('pyramid')">Посмотреть шаблон</button>
            </div>

            <!-- Create Custom Template -->
            <div class="template-card create-custom" onclick="createCustomTemplate()">
                <div class="create-icon">⚙️</div>
                <h3 class="create-title">Создать свой</h3>
                <p class="create-description">
                    Настрой правила под себя: количество шаров, очки, стоимость, штрафы и другие параметры
                </p>
                <button class="create-button">Настроить правила</button>
            </div>
        </div>
    </main>

    <!-- Modal for Creating Custom Template -->
    <div class="modal-overlay" id="createTemplateModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <div class="modal-icon">⚙️</div>
                    <span>Создать свой шаблон</span>
                </div>
                <button class="close-button" onclick="closeCreateModal()">&times;</button>
            </div>
            
            <!-- Template Basic Info -->
            <div class="create-form-section">
                <h3 class="form-section-title">Основная информация</h3>
                
                <div class="form-group">
                    <label class="form-label">Название шаблона</label>
                    <input type="text" class="form-input" id="templateName" placeholder="Введите название шаблона..." />
                </div>
                
                <div class="form-group">
                    <label class="form-label">Описание</label>
                    <textarea class="form-input form-textarea" id="templateDescription" placeholder="Краткое описание правил игры..."></textarea>
                </div>
            </div>
            
            <!-- Game Settings -->
            <div class="create-form-section">
                <h3 class="form-section-title">Настройки игры</h3>
                
                <div class="form-grid">
                    <div class="form-grid-item">
                        <div class="form-grid-title">Количество шаров</div>
                        <div class="form-options" id="ballCountOptions">
                            <div class="form-option selected" data-value="15">15</div>
                            <div class="form-option" data-value="8">8</div>
                            <div class="form-option" data-value="9">9</div>
                            <div class="form-option" data-value="21">21</div>
                        </div>
                    </div>
                    
                    <div class="form-grid-item">
                        <div class="form-grid-title">Лимит времени на ход</div>
                        <div class="form-options" id="timeLimitOptions">
                            <div class="form-option selected" data-value="none">Без лимита</div>
                            <div class="form-option" data-value="5">5 мин</div>
                            <div class="form-option" data-value="10">10 мин</div>
                            <div class="form-option" data-value="15">15 мин</div>
                        </div>
                    </div>
                    
                    <div class="form-grid-item">
                        <div class="form-grid-title">Условие победы</div>
                        <div class="form-options" id="winConditionOptions">
                            <div class="form-option selected" data-value="last">До последнего</div>
                            <div class="form-option" data-value="50">До 50 очков</div>
                            <div class="form-option" data-value="100">До 100 очков</div>
                            <div class="form-option" data-value="custom">Другое</div>
                        </div>
                    </div>
                    
                    <div class="form-grid-item">
                        <div class="form-grid-title">Порядок игры</div>
                        <div class="form-options" id="turnOrderOptions">
                            <div class="form-option selected" data-value="sequential">По очереди</div>
                            <div class="form-option" data-value="random">Случайный</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ball Configuration -->
            <div class="create-form-section">
                <h3 class="form-section-title">Настройки шаров</h3>
                
                <div class="balls-config-grid" id="ballsConfig">
                    <div class="ball-config-item selected" data-ball="white">
                        <div class="config-ball white"></div>
                        <div class="config-ball-name">Белый</div>
                        <input type="text" class="config-ball-input" value="Биток" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="yellow">
                        <div class="config-ball yellow"></div>
                        <div class="config-ball-name">Желтый</div>
                        <input type="text" class="config-ball-input" value="2" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="green">
                        <div class="config-ball green"></div>
                        <div class="config-ball-name">Зеленый</div>
                        <input type="text" class="config-ball-input" value="3" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="brown">
                        <div class="config-ball brown"></div>
                        <div class="config-ball-name">Коричневый</div>
                        <input type="text" class="config-ball-input" value="4" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="blue">
                        <div class="config-ball blue"></div>
                        <div class="config-ball-name">Синий</div>
                        <input type="text" class="config-ball-input" value="5" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="pink">
                        <div class="config-ball pink"></div>
                        <div class="config-ball-name">Розовый</div>
                        <input type="text" class="config-ball-input" value="6" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item selected" data-ball="black">
                        <div class="config-ball black"></div>
                        <div class="config-ball-name">Черный</div>
                        <input type="text" class="config-ball-input" value="7" placeholder="Очки...">
                    </div>
                    
                    <div class="ball-config-item" data-ball="red">
                        <div class="config-ball red"></div>
                        <div class="config-ball-name">Красные</div>
                        <input type="text" class="config-ball-input" value="1" placeholder="Очки...">
                    </div>
                </div>
                
                <p style="color: var(--color-gray-300); font-size: 0.8rem; margin-top: var(--spacing-md);">
                    💡 Нажмите на шар чтобы включить/исключить его из игры
                </p>
            </div>
            
            <!-- Scoring System -->
            <div class="create-form-section">
                <h3 class="form-section-title">Система очков</h3>
                
                <div class="form-grid">
                    <div class="form-grid-item">
                        <div class="form-grid-title">Стоимость одного очка (₽)</div>
                        <div class="price-input-group" id="pointPriceOptions">
                            <div class="price-option selected" data-value="10">10</div>
                            <div class="price-option" data-value="25">25</div>
                            <div class="price-option" data-value="50">50</div>
                            <div class="price-option" data-value="100">100</div>
                            <input type="number" class="price-input" id="customPointPrice" placeholder="Свой" min="1" max="1000">
                        </div>
                    </div>
                    
                    <div class="form-grid-item">
                        <div class="form-grid-title">Штраф за фол (₽)</div>
                        <div class="price-input-group" id="foulPenaltyOptions">
                            <div class="price-option selected" data-value="50">50</div>
                            <div class="price-option" data-value="100">100</div>
                            <div class="price-option" data-value="200">200</div>
                            <input type="number" class="price-input" id="customFoulPenalty" placeholder="Свой" min="1" max="5000">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-action-buttons">
                <button class="modal-button secondary" onclick="closeCreateModal()">Отмена</button>
                <button class="modal-button primary" onclick="saveCustomTemplate()">Создать шаблон</button>
            </div>
        </div>
    </div>

    <!-- Modal for Template Details -->
    <div class="modal-overlay" id="templateModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <div class="modal-icon" id="modalIcon">🎱</div>
                    <span id="modalTitle">Колхоз</span>
                </div>
                <button class="close-button" onclick="closeModal()">&times;</button>
            </div>
            
            <div class="modal-settings-grid" id="modalSettings">
                <!-- Settings will be populated by JavaScript -->
            </div>
            
            <div class="modal-balls-section" id="modalBalls">
                <h3 class="modal-section-title">Настройки шаров</h3>
                <div class="modal-balls-grid" id="modalBallsGrid">
                    <!-- Balls will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="modal-scoring-section" id="modalScoring">
                <h3 class="modal-section-title">Система очков</h3>
                <div class="modal-scoring-grid" id="modalScoringGrid">
                    <!-- Scoring will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="modal-action-buttons">
                <button class="modal-button secondary" onclick="closeModal()">Закрыть</button>
                <button class="modal-button primary" onclick="selectTemplate()">Выбрать шаблон</button>
            </div>
        </div>
    </div>

    <script>
        let currentTemplate = null;
        
        // Данные шаблонов
        const templates = {
            kolkhoz: {
                name: 'Колхоз',
                icon: '🎱',
                settings: {
                    'Количество шаров': '15',
                    'Лимит времени на ход': 'Без лимита',
                    'Условие победы': 'До последнего',
                    'Порядок игры': 'По очереди',
                    'Правило касания': 'Любой шар',
                    'Переигровка': 'При ничьей'
                },
                balls: [
                    { name: 'Белый', points: 'Биток', color: 'white' },
                    { name: 'Желтый', points: '2 очка', color: 'yellow' },
                    { name: 'Зеленый', points: '3 очка', color: 'green' },
                    { name: 'Коричневый', points: '4 очка', color: 'brown' },
                    { name: 'Синий', points: '5 очков', color: 'blue' },
                    { name: 'Розовый', points: '6 очков', color: 'pink' },
                    { name: 'Черный', points: '7 очков', color: 'black' },
                    { name: 'Красные', points: '1 очко (15 шт.)', color: 'red' }
                ],
                scoring: {
                    'Стоимость одного очка': '10₽',
                    'Штраф за фол': '50₽',
                    'Бонус за серию': '20₽ (5+ шаров)',
                    'Штраф за промах': '10₽'
                }
            },
            americana: {
                name: 'Американка',
                icon: '🔴',
                settings: {
                    'Количество шаров': '15',
                    'Лимит времени на ход': '5 мин',
                    'Условие победы': 'Забить 8-ку',
                    'Порядок игры': 'По очереди',
                    'Группы шаров': 'Сплошные/Полосатые',
                    'Правило касания': 'Только свои шары'
                },
                balls: [
                    { name: 'Белый', points: 'Биток', color: 'white' },
                    { name: '1', points: 'Желтый сплошной', color: 'yellow' },
                    { name: '2', points: 'Синий сплошной', color: 'blue' },
                    { name: '3', points: 'Красный сплошной', color: 'red' },
                    { name: '9', points: 'Желтый полосатый', color: 'yellow' },
                    { name: '10', points: 'Синий полосатый', color: 'blue' },
                    { name: '11', points: 'Красный полосатый', color: 'red' },
                    { name: '8', points: 'Черный (решающий)', color: 'black' }
                ],
                scoring: {
                    'Стоимость одного очка': '25₽',
                    'Штраф за фол': '100₽',
                    'Бонус за 8-ку с разбоя': '500₽',
                    'Штраф за досрочную 8-ку': '200₽'
                }
            },
            pyramid: {
                name: 'Пирамида',
                icon: '🔺',
                settings: {
                    'Количество шаров': '15',
                    'Лимит времени на ход': '10 мин',
                    'Условие победы': 'До 71 очка',
                    'Порядок игры': 'По очереди',
                    'Лузы': 'Только угловые',
                    'Правило касания': 'Строгое'
                },
                balls: [
                    { name: 'Белый', points: 'Биток', color: 'white' },
                    { name: 'Желтый', points: '2 очка', color: 'yellow' },
                    { name: 'Зеленый', points: '3 очка', color: 'green' },
                    { name: 'Коричневый', points: '4 очка', color: 'brown' },
                    { name: 'Синий', points: '5 очков', color: 'blue' },
                    { name: 'Розовый', points: '6 очков', color: 'pink' },
                    { name: 'Черный', points: '7 очков', color: 'black' },
                    { name: 'Красные', points: '1 очко (15 шт.)', color: 'red' }
                ],
                scoring: {
                    'Стоимость одного очка': '50₽',
                    'Штраф за фол': '200₽',
                    'Бонус за серию': '100₽ (3+ шара)',
                    'Штраф за неточное касание': '50₽'
                }
            }
        };
        
        function viewTemplate(templateType) {
            console.log('👁️ Viewing template:', templateType);
            currentTemplate = templateType;
            
            const template = templates[templateType];
            if (!template) return;
            
            // Обновляем заголовок модала
            document.getElementById('modalIcon').textContent = template.icon;
            document.getElementById('modalTitle').textContent = template.name;
            
            // Заполняем настройки
            const settingsContainer = document.getElementById('modalSettings');
            settingsContainer.innerHTML = '';
            Object.entries(template.settings).forEach(([key, value]) => {
                const settingItem = document.createElement('div');
                settingItem.className = 'modal-setting-item';
                settingItem.innerHTML = `
                    <div class="modal-setting-title">${key}</div>
                    <div class="modal-setting-value">${value}</div>
                `;
                settingsContainer.appendChild(settingItem);
            });
            
            // Заполняем шары
            const ballsContainer = document.getElementById('modalBallsGrid');
            ballsContainer.innerHTML = '';
            template.balls.forEach(ball => {
                const ballItem = document.createElement('div');
                ballItem.className = 'modal-ball-item';
                ballItem.innerHTML = `
                    <div class="modal-ball ${ball.color}"></div>
                    <div class="modal-ball-name">${ball.name}</div>
                    <div class="modal-ball-points">${ball.points}</div>
                `;
                ballsContainer.appendChild(ballItem);
            });
            
            // Заполняем систему очков
            const scoringContainer = document.getElementById('modalScoringGrid');
            scoringContainer.innerHTML = '';
            Object.entries(template.scoring).forEach(([key, value]) => {
                const scoringItem = document.createElement('div');
                scoringItem.className = 'modal-scoring-item';
                scoringItem.innerHTML = `
                    <div class="modal-scoring-label">${key}</div>
                    <div class="modal-scoring-value">${value}</div>
                `;
                scoringContainer.appendChild(scoringItem);
            });
            
            // Показываем модал
            document.getElementById('templateModal').classList.add('show');
        }
        
        function closeModal() {
            document.getElementById('templateModal').classList.remove('show');
        }
        
        function selectTemplate() {
            if (!currentTemplate) return;
            
            console.log('🎮 Selected template:', currentTemplate);
            
            // Закрываем модал
            closeModal();
            
            // Показываем уведомление
            showNotification(`Выбран шаблон: ${templates[currentTemplate].name}`);
            
            // Здесь можно добавить логику перехода к созданию игры
            // Например: window.location.href = `session-creation-preview.html?template=${currentTemplate}`;
        }
        
        function createCustomTemplate() {
            console.log('⚙️ Creating custom template');
            
            // Открываем модал создания шаблона
            document.getElementById('createTemplateModal').classList.add('show');
        }
        
        function closeCreateModal() {
            document.getElementById('createTemplateModal').classList.remove('show');
        }
        
        function saveCustomTemplate() {
            // Собираем данные формы
            const templateData = {
                name: document.getElementById('templateName').value || 'Мой шаблон',
                description: document.getElementById('templateDescription').value || 'Пользовательский шаблон игры',
                settings: getFormSettings(),
                balls: getBallsConfiguration(),
                scoring: getScoringConfiguration()
            };
            
            // Валидация
            if (!templateData.name.trim()) {
                showNotification('Введите название шаблона!');
                return;
            }
            
            console.log('💾 Saving custom template:', templateData);
            
            // Добавляем в локальную коллекцию шаблонов
            templates.custom = {
                name: templateData.name,
                icon: '⚙️',
                settings: templateData.settings,
                balls: templateData.balls,
                scoring: templateData.scoring
            };
            
            // Закрываем модал
            closeCreateModal();
            
            // Показываем уведомление об успешном создании
            showNotification(`Шаблон "${templateData.name}" создан!`);
            
            // Можно добавить карточку шаблона на страницу
            addCustomTemplateCard(templateData);
        }
        
        function getFormSettings() {
            const settings = {};
            
            // Количество шаров
            const ballCount = document.querySelector('#ballCountOptions .form-option.selected')?.dataset.value || '15';
            settings['Количество шаров'] = ballCount;
            
            // Лимит времени
            const timeLimit = document.querySelector('#timeLimitOptions .form-option.selected')?.dataset.value || 'none';
            settings['Лимит времени на ход'] = timeLimit === 'none' ? 'Без лимита' : `${timeLimit} мин`;
            
            // Условие победы
            const winCondition = document.querySelector('#winConditionOptions .form-option.selected')?.dataset.value || 'last';
            switch(winCondition) {
                case 'last': settings['Условие победы'] = 'До последнего'; break;
                case '50': settings['Условие победы'] = 'До 50 очков'; break;
                case '100': settings['Условие победы'] = 'До 100 очков'; break;
                case 'custom': settings['Условие победы'] = 'Настраиваемое'; break;
            }
            
            // Порядок игры
            const turnOrder = document.querySelector('#turnOrderOptions .form-option.selected')?.dataset.value || 'sequential';
            settings['Порядок игры'] = turnOrder === 'sequential' ? 'По очереди' : 'Случайный';
            
            return settings;
        }
        
        function getBallsConfiguration() {
            const balls = [];
            const ballItems = document.querySelectorAll('#ballsConfig .ball-config-item.selected');
            
            ballItems.forEach(item => {
                const ballColor = item.dataset.ball;
                const ballName = item.querySelector('.config-ball-name').textContent;
                const ballPoints = item.querySelector('.config-ball-input').value || '0';
                
                balls.push({
                    name: ballName,
                    points: ballPoints,
                    color: ballColor
                });
            });
            
            return balls;
        }
        
        function getScoringConfiguration() {
            const scoring = {};
            
            // Стоимость очка
            const pointPriceSelected = document.querySelector('#pointPriceOptions .price-option.selected');
            const customPointPrice = document.getElementById('customPointPrice').value;
            const pointPrice = customPointPrice || pointPriceSelected?.dataset.value || '10';
            scoring['Стоимость одного очка'] = `${pointPrice}₽`;
            
            // Штраф за фол
            const foulPenaltySelected = document.querySelector('#foulPenaltyOptions .price-option.selected');
            const customFoulPenalty = document.getElementById('customFoulPenalty').value;
            const foulPenalty = customFoulPenalty || foulPenaltySelected?.dataset.value || '50';
            scoring['Штраф за фол'] = `${foulPenalty}₽`;
            
            return scoring;
        }
        
        function addCustomTemplateCard(templateData) {
            const templatesGrid = document.querySelector('.templates-grid');
            const createCard = templatesGrid.querySelector('.create-custom');
            
            // Создаем новую карточку шаблона
            const newCard = document.createElement('div');
            newCard.className = 'template-card';
            newCard.onclick = () => viewTemplate('custom');
            
            newCard.innerHTML = `
                <div class="template-icon">⚙️</div>
                <h3 class="template-title">${templateData.name}</h3>
                <p class="template-description">${templateData.description}</p>
                
                <div class="template-settings">
                    <div class="setting-row">
                        <span class="setting-label">Количество шаров:</span>
                        <span class="setting-value">${templateData.settings['Количество шаров']} шаров</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Условие победы:</span>
                        <span class="setting-value">${templateData.settings['Условие победы']}</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Стоимость очка:</span>
                        <span class="setting-value">${templateData.scoring['Стоимость одного очка']}</span>
                    </div>
                    <div class="setting-row">
                        <span class="setting-label">Штраф за фол:</span>
                        <span class="setting-value">${templateData.scoring['Штраф за фол']}</span>
                    </div>
                </div>
                
                <button class="template-button" onclick="event.stopPropagation(); viewTemplate('custom')">Посмотреть шаблон</button>
            `;
            
            // Вставляем перед карточкой "Создать свой"
            templatesGrid.insertBefore(newCard, createCard);
        }
        
        function showNotification(message) {
            // Создаем простое уведомление
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, var(--color-mint), var(--color-primary));
                color: var(--color-black);
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: var(--shadow-lg);
                z-index: 1001;
                font-weight: 600;
                animation: slideIn 0.3s ease-out;
                max-width: 300px;
            `;
            notification.textContent = message;
            
            // Добавляем анимацию
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Убираем уведомление через 3 секунды
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // Закрытие модала по клику вне его
        document.getElementById('templateModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // Закрытие модала по нажатию Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
                closeCreateModal();
            }
        });
        
        // Инициализация обработчиков для формы создания шаблона
        document.addEventListener('DOMContentLoaded', function() {
            initializeFormHandlers();
        });
        
        function initializeFormHandlers() {
            // Обработчики для опций формы
            document.querySelectorAll('.form-option').forEach(option => {
                option.addEventListener('click', function() {
                    // Убираем выделение с других опций в той же группе
                    const group = this.parentElement;
                    group.querySelectorAll('.form-option').forEach(opt => opt.classList.remove('selected'));
                    // Выделяем текущую опцию
                    this.classList.add('selected');
                });
            });
            
            // Обработчики для ценовых опций
            document.querySelectorAll('.price-option').forEach(option => {
                option.addEventListener('click', function() {
                    // Убираем выделение с других опций в той же группе
                    const group = this.parentElement;
                    group.querySelectorAll('.price-option').forEach(opt => opt.classList.remove('selected'));
                    // Выделяем текущую опцию
                    this.classList.add('selected');
                    // Очищаем кастомный инпут в той же группе
                    const customInput = group.querySelector('.price-input');
                    if (customInput) customInput.value = '';
                });
            });
            
            // Обработчики для кастомных ценовых инпутов
            document.querySelectorAll('.price-input').forEach(input => {
                input.addEventListener('focus', function() {
                    // Убираем выделение с предустановленных опций
                    const group = this.parentElement;
                    group.querySelectorAll('.price-option').forEach(opt => opt.classList.remove('selected'));
                });
            });
            
            // Обработчики для конфигурации шаров
            document.querySelectorAll('.ball-config-item').forEach(item => {
                item.addEventListener('click', function(e) {
                    // Не переключаем если кликнули на инпут
                    if (e.target.classList.contains('config-ball-input')) return;
                    
                    // Переключаем выбор шара
                    this.classList.toggle('selected');
                });
            });
            
            // Закрытие модала создания шаблона по клику вне его
            document.getElementById('createTemplateModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeCreateModal();
                }
            });
        }
    </script>
</body>
</html>
