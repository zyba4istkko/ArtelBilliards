FROM node:20-alpine

# Рабочая директория внутри контейнера
WORKDIR /app

# Устанавливаем системные зависимости
RUN apk add --no-cache curl libc6-compat

# Обновляем npm
RUN npm install -g npm@latest

# Копируем package files
COPY package*.json ./

# Устанавливаем зависимости
RUN npm install --force

# Копируем исходники
COPY . .

# Открываем порт Vite
EXPOSE 5174

# Устанавливаем переменную окружения для порта
ENV PORT=5174

# Запускаем Vite dev server с hot reload на порту 5174
CMD ["npm", "run", "dev-hot"]
